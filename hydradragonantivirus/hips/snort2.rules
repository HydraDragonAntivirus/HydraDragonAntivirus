# ##############################################
# Author: ditekSHen
# INDICATOR DOCUMENTS
# INDICATOR PACKED
# INDICATOR POLICY
# INDICATOR SUSPICIOUS
# MALWARE
# Reference: https://github.com/ditekshen/detection
################################################
#alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Generic keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content: "Keylog"; within:150; metadata:ruleset community, service smtp; classtype:trojan-activity; sid:920064; rev:1;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.PingBack download command outbound connection detected"; dsize:788; icode:0; itype:8; content:"download|00|"; fast_pattern:only; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920159; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.PingBack exec command outbound connection detected"; dsize:788; icode:0; itype:8; content:"exec|00|"; fast_pattern:only; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920161; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.PingBack shell command outbound connection detected"; dsize:788; icode:0; itype:8; content:"shell|00|"; fast_pattern:only; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920158; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.PingBack upload command outbound connection detected"; dsize:788; icode:0; itype:8; content:"upload|00|"; fast_pattern:only; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920160; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATE-DOCUMENT RTF document with Equation and BITSAdmin download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"6269747361646d696e"; nocase; metadata:ruleset community, service http, service imap, service pop3, service ftp-data, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910002; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATE-DOCUMENT RTF document with Equation and CertUtil download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"636572747574696c"; nocase; metadata:ruleset community, service http, service imap, service pop3, service ftp-data, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910006; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATE-DOCUMENT RTF document with Equation and PowerShell download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"706f7765727368656c6c"; nocase; metadata:ruleset community, service http, service imap, service pop3, service ftp-data, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910004; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-DOCUMENT Ancalog RTF exploit builder document detected"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"|5C|*|5C|ancalog"; nocase; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_RTF_Ancalog_Exploit_Builder_Document, clamav INDICATOR.RTF.AncalogExploitBuilderDocument; classtype:trojan-activity; sid:910000; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ASPACK packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2E 61 73 70 61 63 6B 00 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ASPack; classtype:policy-violation; sid:930007; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED AVIator executable AV bypass download attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"A|00|V|00|/|00 5C 00|t|00|o|00|r"; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_TOOL_AVBypass_AVIator; classtype:trojan-activity; sid:930076; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED AVIator malicious executable AV bypass download attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|00|APCInjection"; fast_pattern:only; content:"|00|threadHijackin_"; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_TOOL_AVBypass_AVIator; classtype:trojan-activity; sid:930078; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"protected by AspireCrypt"; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_EXE_Packed_AspireCrypt; classtype:policy-violation; sid:930013; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".bxpck"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930038; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"BoxedAppSDK_HookFunction"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930040; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|00|ConfusedByAttribute|00|"; fast_pattern:only; content:"ConfuserEx v"; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserEx; classtype:policy-violation; sid:930017; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Beds Protector"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930020; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930022; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Trinity0-protecor"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930028; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"TrinityProtector"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930026; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.ole|file.msi; file_data; content:"Exe to msi converter free"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_MSI_EXE2MSI; classtype:policy-violation; sid:930062; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Engima packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".enigma"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Enigma; classtype:policy-violation; sid:930053; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Fody manipulated executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"ProcessedByFody"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Fody; classtype:policy-violation; sid:930080; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED LSD packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"the LSD executable packer"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_LSD; classtype:policy-violation; sid:930059; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED LibZ packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|00|LibZInitializer"; fast_pattern:only; content:"|00|LibZ.Injected|00|"; distance:0; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_LibZ; classtype:policy-violation; sid:930056; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED MPRESS packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".MPRESS"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_MPress; classtype:policy-violation; sid:930032; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Nate packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".nate"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Nate; classtype:policy-violation; sid:930035; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED NyanX-CAT CSharpLoader packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|00 50 72 6f 67 72 61 6d 00 4c 6f 61 64 65 72 00 4e 79 61 6e 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_Packed_NyanXCat_CSharpLoader, clamav:INDICATOR.Packed.NyanXCAT-CSharpLoader; classtype:policy-violation; sid:930073; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED PS2EXE packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"PS2EXE"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_PS2EXE; classtype:policy-violation; sid:930004; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED RLPack packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2E 52 4C 50 61 63 6B 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_RLPack; classtype:policy-violation; sid:930064; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Silent Install Builder demo packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2d 00 3e 00 6d 00 62 00 21 00 53 00 69 00 6c 00 65 00 6e 00 74 00 20 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 20 00 42 00 75 00 69 00 6c 00 64 00 65 00 72 00 20 00 44 00 65 00 6d 00 6f|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_SilentInstallBuilder; classtype:policy-violation; sid:930070; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Spices.Net packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator"; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_EXE_Packed_Spices; classtype:policy-violation; sid:930001; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Themida packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2E 74 68 65 6D 69 64 61 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Themida; classtype:policy-violation; sid:930067; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Titan packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2E 74 69 74 61 6E 00 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Titan; classtype:policy-violation; sid:930010; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED VMProtect packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".vmp"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_VMProtect; classtype:policy-violation; sid:930050; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".ex_cod"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930044; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"eXPressor_InstanceChecker_"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930046; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-SUSPICIOUS FOMB binary managed object format file magic detected"; flow:to_client,established; file_data; content:"|46 4F 4D 42|"; depth:4; flowbits:set,file.fomb; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.fireeye.com/blog/threat-research/2019/10/certutil-qualms-they-came-to-drop-fombs.html; classtype:misc-activity; sid:940064; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"MALWARE-OTHER Win.Trojan.Salfarm executable transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"!This Salfram cannot be run in DOS mode."; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_Salfram, clamav MALWARE.Win.Trojan.Salfram; classtype:policy-violation; sid:920085; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-OBFUSCATION Encoded executable download detected - AlienCrypter"; flow:to_client; file_data; content:"</p><p>@@@77,90,"; fast_pattern:only; metadata:ruleset community, service http; classtype:trojan-activity; sid:940061; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-OBFUSCATION Encoded executable download detected - AlienCrypter"; flow:to_client; file_data; content:"</p><p>@@@HH,JA,"; fast_pattern:only; metadata:ruleset community, service http; classtype:trojan-activity; sid:940062; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.BlackNET RAT inbound Ping command detected"; flow:to_client,established; file_data; content:"UGluZw=="; fast_pattern; isdataat:!1,relative; metadata:ruleset community, service http, yara MALWARE_Win_BlackNET, clamav MALWARE.Win.Trojan.BlackNET; classtype:trojan-activity; sid:920082; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> any any (msg:"MALWARE-CNC Win.Trojan.CoinMiningBot update response connection detected"; flow:to_client,established; file_data; content:"|3C|UpdateBot"; content:"|3C|Version"; distance:0; fast_pattern; metadata:ruleset community, service http, yara MALWARE_Win_CoinMiningBot; classtype:trojan-activity; sid:920153; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-OBFUSCATION Spoofed Host header"; flow:to_server,established; content:"Host: 127.0.0.1|0D 0A|"; http_header; fast_pattern:only; metadata:ruleset community, service http; classtype:misc-activity; sid:940060; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Known malicious inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:" Server|30|"; distance:1; fast_pattern; metadata:ruleset community, service ssl, yara MALWARE_Win_QuasarRAT; classtype:trojan-activity; sid:920071; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_client,established; dsize:<25; content:"|3C 7C|SETPING|7C 3E|"; fast_pattern:only; metadata:ruleset community, yara MALWATE_Win_AllaKore; classtype:trojan-activity; sid:920183; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.AsyncRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"AsyncRAT Server"; distance:1; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920067; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.AsyncRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"DcRat Server"; nocase; distance:1; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920125; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.BitRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"BitRAT|30|"; distance:1; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920069; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.OrcusRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03|"; content:"Orcus Server|30|"; distance:2; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920068; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.OrcusRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03|"; content:"OrcusServerCertificate|30|"; distance:2; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920174; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.QuasarRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"Quasar Server CA"; distance:1; fast_pattern; metadata:ruleset community, service ssl, yara MALWARE_Win_QuasarRAT; classtype:trojan-activity; sid:920066; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.RevCode RAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"*.revcode.se|30|"; distance:1; fast_pattern; metadata:ruleset community, service ssl, yara MALWARE_Win_RevCodeRAT, clamav MALWARE.Win.Trojan.RevCodeRAT; classtype:trojan-activity; sid:920070; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT inbound connection"; flow:to_client,established; dsize:<12; content:"400|7C|0|7C|"; content:"@#@!"; distance:1; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920006; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT variant inbound connection detected"; flow:to_client,established; content:"|5C|XpertRAT|7C|"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_XpertRAT; classtype:trojan-activity; sid:920185; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER Remote Administration Tool detected - Imminent"; flow:to_client,established; dsize:48; content:"|2C 00 00 00 02 00 00 00 01|"; fast_pattern:only; content:"$"; distance:2; metadata:ruleset community; classtype:policy-violation; sid:950003; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER Remote Administration Tool detected - RemoteUtilities"; flow:to_client,established; content:"<rman_message version="; fast_pattern:only; content:"<code>3</code>"; content:"</rman_message>"; distance:0; metadata:ruleset community; classtype:policy-violation; sid:950001; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATE-DOCUMENT RTF document with Equation and BITSAdmin download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"6269747361646d696e"; nocase; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910003; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATE-DOCUMENT RTF document with Equation and CertUtil download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"636572747574696c"; nocase; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910007; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATE-DOCUMENT RTF document with Equation and PowerShell download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"706f7765727368656c6c"; nocase; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910005; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-DOCUMENT Ancalog RTF exploit builder document detected"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"|5C|*|5C|ancalog"; nocase; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Ancalog_Exploit_Builder_Document, clamav INDICATOR.RTF.AncalogExploitBuilderDocument; classtype:trojan-activity; sid:910001; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ASPACK packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 61 73 70 61 63 6B 00 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ASPack; classtype:policy-violation; sid:930008; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED AVIator executable AV bypass download attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"A|00|V|00|/|00 5C 00|t|00|o|00|r"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_TOOL_AVBypass_AVIator; classtype:trojan-activity; sid:930077; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED AVIator executable AV bypass download attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|APCInjection"; fast_pattern:only; content:"|00|threadHijackin"; metadata:ruleset community, service smtp, yara INDICATOR_TOOL_AVBypass_AVIator; classtype:trojan-activity; sid:930079; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by AspireCrypt"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_AspireCrypt; classtype:policy-violation; sid:930014; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".bxpck"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930037; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"BoxedAppSDK_HookFunction"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930039; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|ConfusedByAttribute|00|"; fast_pattern:only; content:"ConfuserEx v"; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserEx; classtype:policy-violation; sid:930016; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds Protector"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930019; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930021; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Trinity0-protecor"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930027; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"TrinityProtector"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930025; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.ole|file.msi; file_data; content:"Exe to msi converter free"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_MSI_EXE2MSI; classtype:policy-violation; sid:930061; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Engima packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".enigma"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Enigma; classtype:policy-violation; sid:930052; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Fody manipulated executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"ProcessedByFody"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Fody; classtype:policy-violation; sid:930081; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED LSD packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"the LSD executable packer"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_LSD; classtype:policy-violation; sid:930058; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED LibZ packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|LibZInitializer"; fast_pattern:only; content:"|00|LibZ.Injected|00|"; distance:0; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_LibZ; classtype:policy-violation; sid:930055; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED MPRESS packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".MPRESS"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_MPress; classtype:policy-violation; sid:930031; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Nate packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".nate"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Nate; classtype:policy-violation; sid:930034; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED NyanX-CAT CSharpLoader packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00 50 72 6f 67 72 61 6d 00 4c 6f 61 64 65 72 00 4e 79 61 6e 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_Packed_NyanXCat_CSharpLoader, clamav:INDICATOR.Packed.NyanXCAT-CSharpLoader; classtype:policy-violation; sid:930074; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED PS2EXE packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"PS2EXE"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_PS2EXE; classtype:policy-violation; sid:930005; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED RLPack packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 52 4C 50 61 63 6B 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_RLPack; classtype:policy-violation; sid:930065; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Silent Install Builder demo packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2d 00 3e 00 6d 00 62 00 21 00 53 00 69 00 6c 00 65 00 6e 00 74 00 20 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 20 00 42 00 75 00 69 00 6c 00 64 00 65 00 72 00 20 00 44 00 65 00 6d 00 6f|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_SilentInstallBuilder; classtype:policy-violation; sid:930071; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Spices.Net packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Spices; classtype:policy-violation; sid:930002; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Themida packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 74 68 65 6D 69 64 61 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Themida; classtype:policy-violation; sid:930068; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Titan packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 74 69 74 61 6E 00 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Titan; classtype:policy-violation; sid:930011; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED VMProtect packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".vmp"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_VMProtect; classtype:policy-violation; sid:930049; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".ex_cod"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930043; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"eXPressor_InstanceChecker_"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930045; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-SUSPICIOUS FOMB binary managed object format file magic detected"; flow:to_server,established; file_data; content:"|46 4F 4D 42|"; depth:4; flowbits:set,file.fomb; metadata:ruleset community, service smtp; reference:url,www.fireeye.com/blog/threat-research/2019/10/certutil-qualms-they-came-to-drop-fombs.html; classtype:misc-activity; sid:940065; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"MALWARE-OTHER Win.Trojan.Salfarm executable transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"!This Salfram cannot be run in DOS mode."; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Salfram, clamav MALWARE.Win.Trojan.Salfram; classtype:policy-violation; sid:920086; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Browser cards exfiltration detected"; flow:to_server; content:"Browsers/Cards/PK"; nocase; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920178; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Browser cookies exfiltration detected"; flow:to_server; content:"Browsers/Cookies/PK"; nocase; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920175; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Browser cookies exfiltration detected"; flow:to_server; content:"Browsers/PK"; nocase; http_client_body; content:"Browsers/Cookies ["; nocase; distance:0; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920145; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Browser grabber exfiltration detected"; flow:to_server; content:"Grabber/Desktop/"; nocase; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920177; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Browser logins exfiltration detected"; flow:to_server; content:"Browsers/Logins/PK"; nocase; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920176; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Browser passwords exfiltration detected"; flow:to_server; content:"Browsers/PK"; nocase; http_client_body; content:"Browsers/Passwords ["; nocase; distance:0; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920146; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Screenshot exfiltration detected"; flow:to_server; content:"Screenshots/PK"; nocase; http_client_body; content:"Screenshots/"; nocase; distance:0; http_client_body; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920147; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-SUSPICIOUS User-Agent detected - Moz5"; flow:to_server,established; content:"User-Agent: Moz5|0D 0A|"; fast_pattern:only; http_header; metadata:ruleset community, service http; classtype:policy-violation; sid:940066; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-SUSPICIOUS User-Agent detected - QQ____"; flow:to_server,established; content:"User-Agent: QQ____"; fast_pattern:only; http_header; metadata:ruleset community, service http; classtype:policy-violation; sid:940067; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-SUSPICIOUS User-Agent detected - wget"; flow:to_server,established; content:"User-Agent: wget|0D 0A|"; fast_pattern:only; http_header; metadata:ruleset community, service http; classtype:policy-violation; sid:940068; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-SUSPICIOUS empty User-Agent detected"; flow:to_server,established; content:"User-Agent|3A 20 0D 0A|"; http_header; fast_pattern:only; metadata:ruleset community, service http; classtype:policy-violation; sid:940063; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Doc.Trojan.ReconDoc outbound connection"; flow:to_server,established; content:".php?id="; http_uri; base64_decode:relative; base64_data; content:"document_name:"; content:"|7C|computer_name:"; content:"|7C|user_name:"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920065; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Linux.Trojan.XORDDoS configuration download attempt detected"; flow:to_server,established; content:"|3B 20|TencentTraveler|20 3B|"; http_header; content:"Accept-Language: zh-cn|0D 0A|"; http_header; metadata:ruleset community, service http; reference:www.lacework.com/groundhog-botnet-rapidly-infecting-cloud/; classtype:trojan-activity; sid:920115; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.DecryptMyFiles outbound connection detected"; flow:to_server,established; content:"User-Agent: uniquesession"; fast_pattern:only; http_header; metadata:ruleset community, service http, yara MALWARE_Win_DecryptMyFiles; classtype:trojan-activity; sid:920170; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.DecryptMyFiles outbound connection detected"; flow:to_server,established; content:"api/connect.php"; http_uri; content:"Content-Type: application/text"; http_header; content:"POST"; http_method; metadata:ruleset community, service http, yara MALWARE_Win_DecryptMyFiles; classtype:trojan-activity; sid:920171; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Spyro-VoidCrypt outbound connection detected"; flow:to_server; content:"/voidcrypt/index.php"; fast_pattern:only; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_Spyro; classtype:trojan-activity; sid:920188; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Spyro-VoidCrypt outbound connection detected"; flow:to_server; content:"User-Agent: Voidcrypt/"; fast_pattern:only; nocase; http_header; metadata:ruleset community, service http, yara MALWARE_Win_Spyro; classtype:trojan-activity; sid:920186; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Spyro-VoidCrypt outbound connection detected"; flow:to_server; content:"unique-id="; http_client_body; content:"disk-size="; http_client_body; content:"user="; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_Spyro; classtype:trojan-activity; sid:920187; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.VSSDestroy/Matrix variant post-infection outbound connection"; flow:to_server,established; content:"/addrec.php"; fast_pattern:only; http_uri; content:"apikey="; http_uri; content:"&compuser="; http_uri; content:"&sid="; http_uri; content:"&phase="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_VSSDestroy, clamav MALWARE.Win.VSSDestroy; classtype:trojan-activity; sid:920009; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.VSSDestroy/Matrix variant post-infection outbound connection"; flow:to_server,established; content:"/addrecord.php"; fast_pattern:only; http_uri; content:"apikey="; http_uri; content:"&compuser="; http_uri; content:"&sid="; http_uri; content:"&phase="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_VSSDestroy, clamav MALWARE.Win.VSSDestroy; classtype:trojan-activity; sid:920008; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Ziggy outbound connection detected"; flow:to_server,established; content:"/ziggy/api/info.php"; fast_pattern:only; http_uri; content:"id="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_Ziggy, clamav MALWARE.Win.Ransomware.Ziggy; classtype:trojan-activity; sid:920098; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.AHKStealer exfiltration outbound connnection detected";flow:to_server,established; content:"User-Agent: AutoHotkey|0D 0A|"; http_header; content:"hostname:"; http_client_body; content:"username:"; http_client_body; content:"password:"; http_client_body; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920095; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.AHKStealer initial outbound connnection detected";flow:to_server,established; urilen:15; content:"User-Agent: AutoHotkey|0D 0A|"; http_header; content:"-pro"; offset:11; http_uri; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920093; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.AHKStealer initial outbound connnection detected";flow:to_server,established; urilen:15; content:"User-Agent: AutoHotkey|0D 0A|"; http_header; content:"-xl2"; offset:11; http_uri; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920092; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.AHKStealer status log outbound connnection detected";flow:to_server,established; urilen:11; content:"User-Agent: AutoHotkey|0D 0A|"; http_header; content:"&log=passwords:"; http_client_body; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920094; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Agent downloader outbound connection"; flow:to_server,established; content:"User-Agent: Mozilla/5.0 Gecko/41.0 Firefox/41.0|0D 0A|"; fast_pattern:only; http_header; content:"/?v="; http_uri; content:"&g="; http_uri; metadata:ruleset community, yara MALWARE_Win_DA1, clamav MALWARE.Win.DA1; classtype:trojan-activity; sid:920007; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Amady credentials plugin download detected"; flow:to_server,established; content:"/cred.dll HTTP/1.1|0D 0A|Host:"; fast_pattern:only; content:!"User-Agent:"; http_header; content:!"Connection:"; http_header; metadata:ruleset community, service http, yara INDICATOR_TOOL_PWS_Amady; classtype:trojan-activity; sid:920077; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Amady outbound connection detected"; flow:to_server,established; content:"id="; http_client_body; content:"vs="; http_client_body; content:"sd="; http_client_body; content:"/index.php"; http_uri; content:"POST"; http_method; content:!"User-Agent"; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920076; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Amady screenshot plugin download detected"; flow:to_server,established; content:"/scr.dll HTTP/1.1|0D 0A|Host:"; fast_pattern:only; content:!"User-Agent:"; http_header; content:!"Connection:"; http_header; metadata:ruleset community, service http, yara INDICATOR_TOOL_SCR_Amady; classtype:trojan-activity; sid:920078; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.ArbitriumRAT outbound connection detected"; flow:to_server,established; content:"/checkupdate.js?id=";fast_pattern:only; http_uri; content:"&token="; http_uri; content:"&platform="; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920119; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Banload outbound connection detected"; flow:to_server,established; content:"/checkin?host="; fast_pattern:only; http_uri; content:"&user"; http_uri; content:"User-Agent: Go-"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_Banload; classtype:trojan-activity; sid:920162; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Banload outbound connection detected"; flow:to_server,established; content:"/command?id="; fast_pattern:only; http_uri; content:"User-Agent: Go-"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_Banload; classtype:trojan-activity; sid:920163; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.BazarLoader outbound connection detected"; flow:to_server,established; content:"User-Agent: apiutwq"; fast_pattern:only; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920164; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.BlackNET RAT outbound connection detected"; flow:to_server,established; content:"/connection.php?"; http_uri; fast_pattern:only; content:"data="; http_uri; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_BlackNET, clamav MALWARE.Win.Trojan.BlackNET; classtype:trojan-activity; sid:920079; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.BlackNET RAT outbound connection detected"; flow:to_server,established; content:"/getCommand.php?"; http_uri; fast_pattern:only; content:"id="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_BlackNET, clamav MALWARE.Win.Trojan.BlackNET; classtype:trojan-activity; sid:920081; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.BlackNET RAT outbound connection detected"; flow:to_server,established; content:"/receive.php?"; http_uri; fast_pattern:only; content:"command="; http_uri; content:"&vicID="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_BlackNET, clamav MALWARE.Win.Trojan.BlackNET; classtype:trojan-activity; sid:920080; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CHUWI check command outbound connection detected"; flow:to_server,established; content:"/check_command.php?"; http_uri; fast_pattern:only; content:"HWID={"; nocase; http_uri; content:"&act="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_CHUWI; classtype:trojan-activity; sid:920104; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CHUWI get command outbound connection detected"; flow:to_server,established; content:"/get_command.php?"; http_uri; fast_pattern:only; content:"HWID={"; nocase; http_uri; content:"&command="; http_uri; metadata:ruleset community, service http, yara:MALWARE_Win_CHUWI; classtype:trojan-activity; sid:920105; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CHUWI initial outbound connection detected"; flow:to_server,established; content:"HWID={"; fast_pattern:only; http_client_body; content:"&name="; http_client_body; content:"&os="; http_client_body; metadata:ruleset community, service http, yara:MALWARE_Win_CHUWI; classtype:trojan-activity; sid:920103; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CRAT outbound connection detected"; flow:to_server,established; content:"/index.php?timestamp="; http_uri; fast_pattern:only; content:"id=0"; http_client_body; content:"&content="; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_CRAT; classtype:trojan-activity; sid:920155; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CRAT outbound connection detected"; flow:to_server,established; content:"User-Agent: Mozilla/5.0|0D 0A|"; http_header; content:"/index.php?timestamp="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_CRAT; classtype:trojan-activity; sid:920154; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CoinMiningBot update request connection detected"; flow:to_server,established; urilen:19; content:"/Data/GetUpdateInfo"; http_uri; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_CoinMiningBot; classtype:trojan-activity; sid:920152; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.CryptBot outbound connection detected"; flow:to_server,established; content:"|50 4B 03 04 14 00|"; content:"|00|AllForms_list.txt",distance 0; metadata:ruleset community, service http, yara MALWARE_Win_CryptBot, clamav MALWARE.Win.Trojan.CryptBot; classtype:trojan-activity; sid:920110; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.DCRat outbound connection detected"; flow:to_server; content:"Content-Type: text/csv"; http_header; content:"Accept: */*|0D 0A|"; http_header; content:!"Connection"; http_header; content:".php?"; http_uri; urilen:>150; metadata:ruleset community, service http; classtype:trojan-activity; sid:920144; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.DLAgent07 outbound connection detected"; flow:to_server,established; content:"User-Agent: zipo"; fast_pattern:only; http_header; metadata:ruleset community, service http, yara MALWARE_Win_DLAgent07; classtype:trojan-activity; sid:920165; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.DOC outbound connection detected"; flow:to_server,established; content:"op="; http_uri; content:"dt="; http_uri; content:"uid="; http_uri; content:"Mozilla/4.0 (compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5)"; http_header; metadata:ruleset community, service http; reference:url,blog.alyac.co.kr/3458; classtype:trojan-activity; sid:920097; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.DotNetDownloader outbound connection detected"; flow:to_server,established; urilen:43; content:"/base/"; http_uri; content:!"User-Agent"; http_header; content:!"Content"; http_header; content:!"Accept"; http_header; pcre:"/[A-F0-9]{32}\.html/U"; metadata:ruleset community, service http, yara MALWARE_Win_DLAgent06; classtype:trojan-activity; sid:920122; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Downloader agent outbound connection detected"; flow:to_server,established; content:"/getrandombase64.php?get="; fast_pattern:only; http_uri; content:!"User-Agent"; http_header; content:!"Connection"; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920112; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Downloader outbound connection detected"; flow:to_server,established; content:"/addInstall"; http_uri; content:"key="; http_uri; content:"&ip="; http_uri; content:"&oid="; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920169; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Downloader outbound connection detected"; flow:to_server,established; content:"InnoDownloadPlugin/"; fast_pattern:only; http_header; content:".exe"; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920168; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.FujinamaRAT outbound connection detected"; flow:to_server,established; content:"/copy.php?file= ["; fast_pattern:only; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_FujinamaRAT; classtype:trojan-activity; sid:920124; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Hancitor outbound connection detected"; flow:to_server,established; content:"GUID="; http_client_body; content:"BUILD="; http_client_body; content:"INFO="; http_client_body; content:"TYPE="; http_client_body; content:"WIN="; http_client_body; metadata:ruleset community, service http; classtype:trojan-activity; sid:920084; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound HTTP connection"; flow:to_server,established; content:"Secret="; http_client_body; content:"HWID="; nocase; fast_pattern:only; http_client_body; content:"Name="; nocase; content:"OS="; nocase; http_client_body; content:"Type="; http_client_body; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920045; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.IceRAT coinminer download check detected"; flow:to_server,established; content:"/dow_klip.txt"; fast_pattern:only; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920100; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.IceRAT stealer download check detected"; flow:to_server,established; content:"/dow_stil.txt"; fast_pattern:only; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920099; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.LCPDot outbound connection detected"; flow:to_server,established; content:"Cookie=Enable&CookieV="; http_client_body; content:"&Cookie_Time="; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_LCPDot; reference:blogs.jpcert.or.jp/en/2021/01/Lazarus_malware2.html; classtype:trojan-activity; sid:920118; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound HTTP connection"; flow:to_server,established; content:"token="; http_client_body; content:"&name="; http_client_body; content:"&type="; http_client_body; content:"&data="; http_client_body; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920019; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.PandaStealer outbound connection detected"; flow:to_server,established; content:"/collect.php"; http_uri; content:"User-Agent: uploader"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_PandaStealer; classtype:trojan-activity; sid:920173; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Phorpiex variant outbound connection detected"; flow:to_server,established; content:"/tst.php"; http_uri; content:"User-Agent: Mozilla/5.0 (iPhone|3B|"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_Phorpiex; classtype:trojan-activity; sid:920172; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Poullight outbound connection detected"; flow:to_server,established; content:"b-mon="; content:"avinstall="; content:"_version_="; metadata:ruleset community, service http, yara MALWARE_Win_Poullight, clamav MALWARE.Win.Trojan.Poullight; classtype:trojan-activity; sid:920075; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Poullight outbound connection detected"; flow:to_server,established; content:"zipx="; http_client_body; content:"Expect: 100-continue"; http_header; content:"Content-Type: application/x-www-form-urlencoded"; http_header; content:".php"; http_uri; content:"POST"; http_method; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_Poullight, clamav MALWARE.Win.Trojan.Poullight; classtype:trojan-activity; sid:920074; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.PowerPool execute command detected"; flow:to_server,established; urilen:8; content:"/cmdpool"; http_uri; fast_pattern:only; content:"User-Agent: Mozilla/4.0 (compatible|3b| )"; http_header; content:"|22|dos|22|"; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_PowerPool_STG2, clamav MALWARE.Win.Trojan.PowerPool-STG-2; classtype:trojan-activity; sid:920090; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.PowerPool heartbeat detected"; flow:to_server,established; urilen:6; content:"/heart"; http_uri; fast_pattern:only; content:"User-Agent: Mozilla/4.0 (compatible|3b| )"; http_header; content:"|22|sessionid|22|"; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_PowerPool_STG2, clamav MALWARE.Win.Trojan.PowerPool-STG-2; classtype:trojan-activity; sid:920089; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.PowerPool initial outbound connection detected"; flow:to_server,established; content:"/?id="; http_uri; content:"&info="; distance:16; fast_pattern; http_uri; content:!"Accept-"; http_header; content:!"Referer"; http_header; content:!"Content"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_PowerPool_STG1, clamav MALWARE.Win.Trojan.PowerPool-STG-1; classtype:trojan-activity; sid:920088; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.PowerPool list directory detected"; flow:to_server,established; urilen:8; content:"/cmdpool"; http_uri; fast_pattern:only; content:"User-Agent: Mozilla/4.0 (compatible|3b| )"; http_header; content:"|22|folder|22|"; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_PowerPool_STG2, clamav MALWARE.Win.Trojan.PowerPool-STG-2; classtype:trojan-activity; sid:920091; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.PyMICROPSIA outbound connection detected"; flow:to_server,established; content:"/zoailloaze/"; http_uri; content:"User-Agent: python-requests/"; http_header; metadata:ruleset community, service http; reference:url,unit42.paloaltonetworks.com/pymicropsia/; classtype:trojan-activity; sid:920096; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.QuilClipper outbound connection detected"; flow:to_server,established; content:"User-Agent: QUILCLIPPER"; http_header; nocase; fast_pattern:only; metadata:ruleset community, service http; classtype:trojan-activity; sid:920111; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Razy infostealer outbound connection detected"; flow:to_server,established; content:"type="; http_client_body; content:"seller="; http_client_body; content:"guid="; http_client_body; content:"origin="; http_client_body; metadata:ruleset community, service http; classtype:trojan-activity; sid:920123; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Redosdru downloader outbound connection detected"; flow:to_server,established; content:"User-Agent: Mozilla/4.0 (compatible)|0D 0A|"; fast_pattern:only; http_header; content:"Cache-Control: no-cache|0D 0A|"; http_header; content:!"Connection"; http_header; content:!"Content-Type"; http_header; content:!"Accept"; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920126; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.STOP ransomware outbound connection detected"; flow:to_server,established; content:"/get.php?pid="; fast_pattern:only; http_uri; content:"&first="; http_uri; content:"User-Agent: Microsoft Internet Explorer"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_STOP, clamav MALWARE.Win.Ransomware.STOP; classtype:trojan-activity; sid:920113; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Sn0w logger outbound connection detected"; flow:to_server,established; content:"User-Agent: RestSharp/"; http_header; content:"/upload"; http_uri; content:"Content-Type: multipart/form-data|3B|"; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920120; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Sn0w logger outbound connection detected"; flow:to_server,established; content:"name=|22|token|22|"; http_client_body; content:"filename=|22|snow.txt|22|"; http_client_body; metadata:ruleset community, service http; classtype:trojan-activity; sid:920121; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.TA505 PWSH DLL exfilatration outbound connection detected"; flow:to_server,established; content:"/jquery.php"; http_uri; content:"User-Agent: Embarcadero URI Client/"; http_header; content:"POST"; http_method; metadata:ruleset community, service http; reference:url,www.fsec.or.kr/common/proc/fsec/bbs/163/fileDownLoad/2297.do; classtype:trojan-activity; sid:920106; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.TA505 PWSH DLL exfilatration outbound connection detected"; flow:to_server,established; content:"key="; http_client_body; content:"sysid="; http_client_body; content:"resp="; http_client_body; metadata:ruleset community, service http; reference:url,www.fsec.or.kr/common/proc/fsec/bbs/163/fileDownLoad/2297.do; classtype:trojan-activity; sid:920107; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.TYRAT outbound connection detected"; flow:to_server,established; content:".db HTTP/1.1"; content:"Accept-Language: zh-cn"; http_header; content:!"Connection"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_TYRAT; classtype:trojan-activity; sid:920167; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.TYRAT outbound connection detected"; flow:to_server,established; content:"/TY.jpg"; http_uri; content:"Accept-Language: zh-cn|0D 0A|"; http_header; content:!"Connection"; http_header; metadata:ruleset community, service http, yara:MALWARE_Win_TYRAT; classtype:trojan-activity; sid:920166; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Taurus outbound connection detected"; flow:to_server,established; urilen:4; content:"/cfg/"; fast_pattern:only; http_uri; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920108; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Taurus outbound connection detected"; flow:to_server,established; urilen:4; content:"/dll/"; fast_pattern:only; http_uri; content:"POST"; http_method; metadata:ruleset community, service http; classtype:trojan-activity; sid:920109; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Torsima outbound connection detected"; flow:to_server,established; content:"ACTION=PREVPAGE&CODE=C"; http_client_body; content:"&RES="; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_Torisma; reference:blogs.jpcert.or.jp/en/2021/01/Lazarus_malware2.html; classtype:trojan-activity; sid:920117; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Torsima outbound connection detected"; flow:to_server,established; content:"ACTION=VIEW&PAGE="; http_client_body; content:"&CODE="; http_client_body; content:"&CACHE="; http_client_body; content:"REQUEST="; http_client_body; metadata:ruleset community, service http, yara MALWARE_Win_Torisma; reference:blogs.jpcert.or.jp/en/2021/01/Lazarus_malware2.html; classtype:trojan-activity; sid:920116; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.TriumphLoader outbound connection detected"; flow:to_server,established; content:"User-Agent: TriumphLoader";fast_pattern:only; http_header; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_TriumphLoader, clamav INDICATOR.Packed.TriumphLoader; classtype:trojan-activity; sid:920101; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Unknown rogue HTTP version outbound connection detected"; flow:to_server,established; content:"HTTPS/11."; depth:9; metadata:ruleset community, service http; reference:www.virustotal.com/gui/file/561064dddadbb6d96134d8cd9c46d51b70206ff7adcd034b8380f6010b0dc56e/detection/f-561064dddadbb6d96134d8cd9c46d51b70206ff7adcd034b8380f6010b0dc56e-1611655862; classtype:trojan-activity; sid:920114; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Wacapew infostealer outbound connection detected"; flow:to_server,established; content:"/info/"; http_uri; content:"info="; http_client_body; content:"User-Agent: Mozilla/5.0 (Windows NT 10.0|3B|"; http_header; content:"Accept-Language: ko-KR"; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920083; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Iluminati proxy/anonymizer download/upgrade detected"; flow:to_server,established; content:"/admin/rmt/luminati.io/"; fast_pattern:only; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:950004; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR CO_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920059; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR KL_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920061; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR PW_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920058; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR SC_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920060; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STOR HawkEyeKeylogger"; depth:21; fast_pattern; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920044; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STOR HawkEyeReborn"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920042; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Ransomware.JobCryptor outbound SMTP connection"; flow:to_server,established; content:"RTEE="; content:"RRTC:"; within:20; fast_pattern; metadata:ruleset community, service smtp; reference:url,yoroi.company/research/ransomware-micro-criminals-are-still-out-here-and-growing/; classtype:trojan-activity; sid:920156; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:" Recovered Accounts"; within:150; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920053; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"Passwords Recovered From: "; within:150; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920051; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"Screen Capture From: "; within:150; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920052; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: CO_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920055; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: KL_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920057; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: PW_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920054; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: SC_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920056; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AspireLogger outbound SMTP connection"; flow:to_server,established; content:"PC:"; content:"IP:"; within:88; content:"Aspire"; metadata:ruleset community, service smtp, yara MALWARE_Win_Aspire, clamav MALWARE.Win.Aspire; classtype:trojan-activity; sid:920047; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AspireLogger outbound SMTP connection"; flow:to_server,established; content:"Subject: AspireLogger ["; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Aspire, clamav MALWARE.Win.Aspire; classtype:trojan-activity; sid:920046; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Firebird/Hive RAT outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:": PASSWORDS"; within:150; metadata:ruleset community, service smtp, yara MALWARE_Win_FirebirdRAT, clamav MALWARE.Win.FirebirdRAT; classtype:trojan-activity; sid:920050; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Generic keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content: "Screen Capture"; within:150; metadata:ruleset community, service smtp; classtype:trojan-activity; sid:920063; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"- Keyboard Logs -"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920035; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"- Passwords Logs -"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920034; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: Logger - Server Ran"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920036; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: Logger|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920037; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.MassLogger outbound SMTP connection"; flow:to_server,established; content:"Subject: MassLogger |7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_MassLogger, clamav MALWARE.Win.MassLogger; classtype:trojan-activity; sid:920062; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Orion keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Orion Logger"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Orion, clamav MALWARE.Win.Orion; classtype:trojan-activity; sid:920048; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Orion keylogger outbound SMTP connection"; flow:to_server,established; content:"System Details |7C|=3D="; content:"=0D=0AComputer Name:"; content:"=0D=0ACountry Name:"; metadata:ruleset community, service smtp, yara MALWARE_Win_Orion, clamav MALWARE.Win.Orion; classtype:trojan-activity; sid:920049; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"IP:"; content:"Owner Name:"; content:"OS Name:"; content:"Platform:"; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920030; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"Keylogger - Passwords -------|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920028; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"PSWD |7C| Client Name:"; within:50; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920027; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"|3B| name=|22|PXRecoveries |7C|"; fast_pattern; content:".txt"; within:30; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920029; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg: "MALWARE-CNC Win.Trojan.DLAgent outbound connection detected"; flow:to_server,established; content:"Content-Type: text/html MySpecialHeder:"; fast_pattern; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920129; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg: "MALWARE-CNC Win.Trojan.PUA adware outbound connection detected"; flow:to_server,established; content:"/api/userapi.ashx?action=",fast_pattern; http_uri; content:"User-Agent: Mozilla/4.0"; http_header; metadata:ruleset community, service http; classtype:trojan-activity; sid:920130; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg: "MALWARE-CNC Win.Trojan.STRRAT outbound connection detected"; flow:to_server,established; content:"|7C|STRRAT|7C|"; fast_pattern:only; metadata:ruleset community; classtype:trojan-activity; sid:920143; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C download payload outbound connection"; flow:to_server,established; content:"X-UploadFileJob:"; fast_pattern:only; http_header; content:"Referer:"; http_header; pcre:"/X-UploadFileJob:\s(true|false)\x0d\x0a/H"; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920015; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"./mshtml,RunHTMLApplication"; fast_pattern:only; http_uri; content:"/html?"; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920016; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"=stage|3B|"; http_uri; content:"/html?"; http_uri; content:"Referer:"; http_header; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920017; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"encoder:"; http_header; content:"shellchcp:"; http_header; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920013; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"errdesc:"; http_header; content:"errno:"; http_header; content:"errname:"; http_header; content:"Referer:"; http_header; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920014; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework Windows host information exfiltration"; flow:to_server,established; content:"~~~Windows"; http_client_body; content:"~~~AMD"; distance:0; http_client_body; content:"~~~C:|5C|Users"; distance:0; http_client_body; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920018; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Osx.Trojan.Pirrit outbound connection detected"; flow:to_server,established; content:"/c/ci?"; http_uri; content:"tm="; http_uri; content:"&id="; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920142; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Osx.Trojan.Pirrit outbound connection detected"; flow:to_server,established; content:"id="; http_uri; content:"pv="; http_uri; content:"mvr="; http_uri; content:"mvsi="; http_uri; content:"ch="; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920141; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.Alfonso stealer outbound connection detected"; flow:to_server,established; content:"|50 4B 03 04 14 00|"; content:"|00|Desktop.png"; distance:0; metadata:ruleset community, yara MALWARE_Win_Alfonoso, clamav MALWARE.Win.Trojan.Alfonso; classtype:trojan-activity; sid:920102; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; content:"|3C 7C|DESKTOPSOCKET|7C 3E|"; fast_pattern:only; metadata:ruleset community, yara MALWATE_Win_AllaKore; classtype:trojan-activity; sid:920180; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; content:"|3C 7C|FILESSOCKET|7C 3E|"; fast_pattern:only; metadata:ruleset community, yara MALWATE_Win_AllaKore; classtype:trojan-activity; sid:920181; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; content:"|3C 7C|KEYBOARDSOCKET|7C 3E|"; fast_pattern:only; metadata:ruleset community, yara MALWATE_Win_AllaKore; classtype:trojan-activity; sid:920182; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; dsize:14; content:"|3C 7C|MAINSOCKET|7C 3E|"; fast_pattern:only; metadata:ruleset community, yara MALWATE_Win_AllaKore; classtype:trojan-activity; sid:920179; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.CobianRAT outbound connection detected"; flow:to_server,established; content:"LOGIN|7C|-|7C|"; fast_pattern:only; metadata:ruleset community; reference:url,www.zscaler.com/blogs/security-research/cobian-rat-backdoored-rat; classtype:trojan-activity; sid:920157; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.FakeSupport outbound connection detected"; flow:to_server,established; content:"/api_update.php?id="; fast_pattern:only; http_uri; content:"TeamViewer_id="; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920138; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; content:"/add?type=name";fast_pattern:only; http_uri; content:"POST"; http_method; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920133; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; content:"/delete?type=name";fast_pattern:only; http_uri; content:"POST"; http_method; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920134; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; content:"/new?type=name";fast_pattern:only; http_uri; content:"POST"; http_method; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920132; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; content:"/renew?type=name";fast_pattern:only; http_uri; content:"POST"; http_method; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920135; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; content:"/show?type=name";fast_pattern:only; http_uri; content: "POST"; http_method; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920131; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; content:"?type=name"; http_uri; content:"Mozilla/4.0 (compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5)"; http_header; content:"POST"; http_method; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920136; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine AutoHotKey downloader outbound connection detected"; flow:to_server,established; content:"/bestof/gfers.exe"; fast_pattern:only; http_uri; metadata:ruleset community, service http; classtype:trojan-activity; sid:920139; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine GetArguments outbound connection detected"; flow:to_server,established; content: "SOAPAction:"; http_header; content:"/Endpoint/GetArguments|22 0D 0A|"; http_header; fast_pattern:only; urilen:1; content:"POST"; http_method; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920148; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine GetSettings outbound connection detected"; flow:to_server,established; content:"/IRemotePanel/GetSettings|22 0D 0A|"; http_header; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920073; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine GetTasks outbound connection detected"; flow:to_server,established; content:"/IRemotePanel/GetTasks|22 0D 0A|"; http_header; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920128; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine GetUpdates outbound connection detected"; flow:to_server,established; content: "SOAPAction:"; http_header; content:"/Endpoint/GetUpdates|22 0D 0A|"; http_header; fast_pattern:only; urilen:1; content:"POST"; http_method; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920150; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine SendClientInfo outbound connection detected"; flow:to_server,established; content:"/IRemotePanel/SendClientInfo|22 0D 0A|"; http_header; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920127; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine VerifyScanRequest outbound connection detected"; flow:to_server,established; content: "SOAPAction:"; http_header; content:"/Endpoint/VerifyScanRequest|22 0D 0A|"; http_header; fast_pattern:only; urilen:1; content:"POST"; http_method; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920149; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine VerifyUpdate outbound connection detected"; flow:to_server,established; content: "SOAPAction:"; http_header; content:"/Endpoint/VerifyUpdate|22 0D 0A|"; http_header; fast_pattern:only; urilen:1; content:"POST"; http_method; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920151; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RedLine initial outbound connection detected"; flow:to_server,established; urilen:13; content:"/IRemotePanel"; http_uri; fast_pattern:only; content:"SOAPAction:"; http_header; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_RedLine, clamav MALWARE.Win.Trojan.RedLine-1 MALWARE.Win.Trojan.RedLine-2; classtype:trojan-activity; sid:920072; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RevengeRAT PNC outbound connection"; flow:to_server,established; content:"PNC!@#%"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_RevengeRAT, clamav MALWARE.Win.RevengeRAT; classtype:trojan-activity; sid:920002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RevengeRAT information outbound connection"; flow:to_server,established; content:"InformationRevenge-RAT"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_RevengeRAT, clamav MALWARE.Win.RevengeRAT; classtype:trojan-activity; sid:920000; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RevengeRAT keep alive outbound connection"; flow:to_server,established; content:"keepAlivePing!!@#%"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_RevengeRAT, clamav MALWARE.Win.RevengeRAT; classtype:trojan-activity; sid:920001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.Unknown outbound connection detected"; flow:to_server,established; content:"User-Agent: A WinHTTP Example Program/"; http_header; content:"info="; http_client_body; metadata:ruleset community, service http; classtype:trojan-activity; sid:920140; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.VJWorm variant outbound connection"; flow:to_server,established; content:"User-Agent: vjw0rm"; nocase; fast_pattern:only; metadata:ruleset community, service http; classtype:trojan-activity; sid:920137; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.WSHRAT variant outbound connection"; flow:to_server,established; content:"User-Agent: WSHRAT"; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_WSHRAT, clamav MALWARE.Win.WSHRAT; classtype:trojan-activity; sid:920010; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.WSHRAT variant outbound connection"; flow:to_server,established; content:"user-agent:: <|7C|>"; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_WSHRAT, clamav MALWARE.Win.WSHRAT; classtype:trojan-activity; sid:920011; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.WSHRAT variant second stage outbound connection"; content: "GET"; http_method; content:"/open-keylogger HTTP/1."; within:23; metadata:ruleset community, service http, yara MALWARE_Win_WSHRAT, clamav MALWARE.Win.WSHRAT; classtype:trojan-activity; sid:920012; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"400|7C|root|7C|"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920003; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"|7C|root|7C|"; within:9; fast_pattern; pcre:"/\d{1,3}\x7croot\x7c\d/"; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920005; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; dsize:10; content:"|7C|root|7C|"; offset:3; depth:6; fast_pattern; isdataat:!1,relative; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920004; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT variant outbound connection detected"; flow:to_server,established; content:"X - Xpert|7C|"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_XpertRAT; classtype:trojan-activity; sid:920184; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POLICY-OTHER Remote Administration Tool detected - Imminent"; flow:to_server,established; dsize:10; content:"|06 00 00 00 81 13 14 6E 5B 69|"; fast_pattern:only; metadata:ruleset community; classtype:policy-violation; sid:950002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POLICY-OTHER Remote Administration Tool detected - RemoteUtilities"; flow:to_server,established; content:"<rman_message version="; fast_pattern:only; content:"<code>1</code>"; metadata:ruleset community; classtype:policy-violation; sid:950000; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS 21 (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STORHawkEye"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920043; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"SGF3a0V5ZSBLZXlsb"; fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920039; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"SGF3a0V5ZSBSZ"; fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920038; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: HawkEye Keylogger"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920040; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: HawkEye Reborn"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920041; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Clipboard"; flow:to_server,established; content:"Subject: Clipboard Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920025; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Execution"; flow:to_server,established; content:"Subject: Execution Alert!"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920020; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Keystroke"; flow:to_server,established; content:"Subject: KeyStroke Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920022; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Password"; flow:to_server,established; content:"Subject: Password Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920021; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Screen"; flow:to_server,established; content:"Subject: Screen Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920023; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Webcam"; flow:to_server,established; content:"Subject: WebCam Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920024; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection"; flow:to_server,established; content:"U3RlYWxlciBMb2dz"; fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920026; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Logs|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920032; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: PSWD|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920031; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Screenshot|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920033; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ASPACK packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 61 73 70 61 63 6B 00 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ASPack; classtype:policy-violation; sid:930009; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by AspireCrypt"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_AspireCrypt; classtype:policy-violation; sid:930015; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".bxpck"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930041; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"BoxedAppSDK_HookFunction"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930042; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|ConfusedByAttribute|00|"; fast_pattern:only; content:"ConfuserEx v"; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserEx; classtype:policy-violation; sid:930018; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930023; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930024; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Trinity0-protecor"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930029; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"TrinityProtectorr"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930030; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.ole|file.msi; file_data; content:"Exe to msi converter free"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_MSI_EXE2MSI; classtype:policy-violation; sid:930063; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Engima packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".enigma"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Enigma; classtype:policy-violation; sid:930054; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Fody manipulated executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"ProcessedByFody"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Fody; classtype:policy-violation; sid:930082; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED LSD packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"the LSD executable packer"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_LSD; classtype:policy-violation; sid:930060; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED LibZ packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|LibZInitializer"; fast_pattern:only; content:"|00|LibZ.Injected|00|"; distance:0; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_LibZ; classtype:policy-violation; sid:930057; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED MPRESS packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".MPRESS"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_MPress; classtype:policy-violation; sid:930033; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Nate packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".nate"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Nate; classtype:policy-violation; sid:930036; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED NyanX-CAT CSharpLoader packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00 50 72 6f 67 72 61 6d 00 4c 6f 61 64 65 72 00 4e 79 61 6e 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_Packed_NyanXCat_CSharpLoader, clamav:INDICATOR.Packed.NyanXCAT-CSharpLoader; classtype:policy-violation; sid:930075; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED PS2EXE packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"PS2EXE"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_PS2EXE; classtype:policy-violation; sid:930006; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED RLPack packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 52 4C 50 61 63 6B 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_RLPack; classtype:policy-violation; sid:930066; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Silent Install Builder demo packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2d 00 3e 00 6d 00 62 00 21 00 53 00 69 00 6c 00 65 00 6e 00 74 00 20 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 20 00 42 00 75 00 69 00 6c 00 64 00 65 00 72 00 20 00 44 00 65 00 6d 00 6f|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_SilentInstallBuilder; classtype:policy-violation; sid:930072; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Spices.Net packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Spices; classtype:policy-violation; sid:930003; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Themida packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 74 68 65 6D 69 64 61 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Themida; classtype:policy-violation; sid:930069; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Titan packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 74 69 74 61 6E 00 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Titan; classtype:policy-violation; sid:930012; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED VMProtect packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".vmp"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_VMProtect; classtype:policy-violation; sid:930051; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".ex_cod"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930047; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"eXPressor_InstanceChecker_"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930048; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"MALWARE-OTHER Win.Trojan.Salfarm executable transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"!This Salfram cannot be run in DOS mode."; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara MALWARE_Win_Salfram, clamav MALWARE.Win.Trojan.Salfram; classtype:policy-violation; sid:920087; rev:1;)
