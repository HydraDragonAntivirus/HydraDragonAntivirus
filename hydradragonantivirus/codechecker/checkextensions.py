import winreg

# Registry paths for file extensions
registry_paths = [
    (winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Classes"),
    (winreg.HKEY_CURRENT_USER, r"SOFTWARE\Classes")
]

# Lists to store new file extensions
new_hklm_file_types = []
new_hkcu_file_types = []

def get_registry_file_types(root_key, sub_key):
    found_extensions = []
    try:
        with winreg.OpenKey(root_key, sub_key) as key:
            i = 0
            while True:
                try:
                    subkey = winreg.EnumKey(key, i)
                    if subkey.startswith('.'):
                        found_extensions.append(subkey.lower())  # Convert to lowercase
                    i += 1
                except OSError:
                    break
    except FileNotFoundError:
        print(f"Registry key {sub_key} not found")
    return found_extensions

# Get file extensions from HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER
hklm_file_types = get_registry_file_types(winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Classes")
hkcu_file_types = get_registry_file_types(winreg.HKEY_CURRENT_USER, r"SOFTWARE\Classes")

fileTypes = ['.pyd', '.elf', '.ps1', '.bas', '.bat', '.chm', '.cmd', '.com', '.cpl', '.dll', '.exe', '.msc', '.ocx', '.pcd', '.pif', '.reg', '.scr', '.sct', '.url', '.vbe', '.wsc', '.wsf', '.wsh', '.ct', '.t', '.input', '.war', '.jspx', '.tmp', '.dump', '.pwd', '.w', '.cfg', '.psd1', '.psm1', '.ps1xml', '.clixml', '.psc1', '.pssc', '.www', '.rdp', '.msi', '.dat', '.contact', '.settings', '.odt', '.jpg', '.mka','shtml', '.mhtml', '.oqy', '.png', '.csv', '.py', '.sql', '.mdb', '.html', '.htm', '.xml', '.psd', '.pdf', '.xla', '.cub', '.dae', '.indd', '.cs', '.mp3', '.mp4', '.dwg', '.rar', '.mov', '.rtf', '.bmp', '.mkv', '.avi', '.apk', '.lnk', '.dib', '.dic', '.dif', '.divx', '.iso', '.7zip', '.ace', '.arj', '.bz2', '.cab', '.gzip', '.lzh', '.jpeg', '.xz', '.mpeg', '.torrent', '.mpg', '.core', '.pdb', '.ico', '.pas', '.db', '.wmv', '.swf', '.cer', '.bak', '.backup', '.accdb', '.bay', '.p7c', '.exif', '.vss', '.raw', '.m4a', '.wma', '.flv', '.sie', '.sum', '.ibank', '.wallet', '.css', '.js', '.rb', '.xlsm', '.xlsb', '.7z', '.cpp', '.java', '.jpe', '.ini', '.blob', '.wps', '.wav', '.3gp', '.webm', '.m4v', '.amv', '.m4p', '.svg', '.ods', '.bk', '.vdi', '.vmdk', '.accde', '.json', '.gif', '.gz', '.m1v', '.sln', '.pst', '.obj', '.xlam', '.djvu', '.inc', '.cvs', '.dbf', '.tbi', '.wpd', '.dot', '.dotx', '.xltx', '.pptm', '.potx', '.potm', '.xlw', '.xps', '.xsd', '.xsf', '.xsl', '.kmz', '.accdr', '.stm', '.accdt', '.ppam', '.pps', '.ppsm', '.1cd', '.3ds', '.3fr', '.3g2', '.accda', '.accdc', '.accdw', '.adp', '.ai', '.ai3', '.ai4', '.ai5', '.ai6', '.ai7', '.ai8', '.arw', '.ascx', '.asm', '.asmx', '.avs', '.bin', '.cfm', '.dbx', '.dcm', '.dcr', '.pict', '.rgbe', '.dwt', '.f4v', '.exr', '.kwm', '.max', '.mda', '.mde', '.mdf', '.mdw', '.mht', '.mpv', '.msg', '.myi', '.nef', '.odc', '.geo', '.swift', '.odm', '.odp', '.oft', '.orf', '.pfx', '.p12', '.pls', '.safe', '.tab', '.vbs', '.xlk', '.xlm', '.xlt', '.xltm', '.svgz', '.slk', '.dmg', '.ps', '.psb', '.tif', '.rss', '.key', '.vob', '.epsp', '.dc3', '.iff', '.onepkg', '.onetoc2', '.opt', '.p7b', '.pam', '.r3d', '.pkg', '.yml', '.old', '.thmx', '.keytab', '.h', '.php', '.c', '.zip', '.log', '.log1', '.log2', '.tm', '.blf', '.uic', '.widget-plugin', '.regtrans-ms', '.efi', '.rule', '.rules', '.yar', '.yara', '.yrc', '.inf', '.ini', '.ndb', '.cvd', '.cld', '.ign2', '.dmp', '.conf' '.config', '.pyc', '.386', '.3gp2', '.3gpp', '.3mf', '.a', '.a2s', '.aac', '.ac3', '.accessor', '.accountpicture-ms', '.adt', '.adts', '.aif', '.aifc', '.aiff', '.androidproj', '.ani', '.ans', '.appcontent-ms', '.application', '.appref-ms', '.aps', '.arc', '.ari', '.art', '.asa', '.asax', '.asc', '.asf', '.ashx', '.asp', '.aspx', '.asx', '.au', '.avci', '.avcs', '.avif', '.avifs', '.bcp', '.bkf', '.blg', '.bsc', '.camp', '.cap', '.cat', '.cc', '.cda', '.cdmp', '.cdx', '.cdxml', '.cgm', '.chk', '.cjs', '.cls', '.cod', '.coffee', '.compositefont', '.config', '.coverage', '.cppm', '.cr2', '.cr3', '.crl', '.crt', '.crw', '.csa', '.csh', '.cshader', '.cshtml', '.csproj', '.cts', '.cur', '.cxx', '.datasource', '.dbg', '.dbs', '.dcs', '.dct', '.dctx', '.dctxc', '.dds', '.def', '.der', '.desklink', '.deskthemepack', '.devicemanifest-ms', '.devicemetadata-ms', '.diagcab', '.diagcfg', '.diagpkg', '.diagsession', '.disco', '.diz', '.dl_', '.dng', '.doc', '.docx', '.dos', '.drf', '.drv', '.dsgl', '.dsh', '.dshader', '.dsn', '.dsp', '.dsw', '.dtcp-ip', '.dtd', '.dvr-ms', '.ec3', '.edmx', '.eip', '.emf', '.eml', '.eps', '.epub', '.erf', '.etl', '.etp', '.evt', '.evtx', '.exp', '.ext', '.ex_', '.eyb', '.faq', '.fff', '.fif', '.filters', '.fky', '.flac', '.fnd', '.fnt', '.fon', '.fx', '.generictest', '.ghi', '.gitattributes', '.gitignore', '.gitmodules', '.gmmp', '.group', '.grp', '.gsh', '.gshader', '.hdd', '.hdp', '.heic', '.heics', '.heif', '.heifs', '.hh', '.hhc', '.hif', '.hlp', '.hlsl', '.hlsli', '.hpp', '.hqx', '.hsh', '.hshader', '.hta', '.htc', '.htt', '.htw', '.htx', '.hxx', '.i', '.ibq', '.icc', '.icl', '.icm', '.ics', '.idb', '.idl', '.idq', '.igp', '.iiq', '.ilk', '.imc', '.imesx', '.img', '.inl', '.inv', '.inx', '.in_', '.ipp', '.itrace', '.ivf', '.ixx', '.jav', '.jbf', '.jfif', '.job', '.jod', '.jse', '.jsonld', '.jsproj', '.jsx', '.jxr', '.k25', '.kci', '.kdc', '.label', '.latex', '.less', '.lgn', '.lib', '.library-ms', '.lic', '.local', '.lpcm', '.lst', '.m14', '.m2t', '.m2ts', '.m2v', '.m3u', '.m4b', '.mak', '.man', '.manifest', '.map', '.mapimail', '.master', '.mef', '.mfcribbon-ms', '.mid', '.midi', '.mjs', '.mk', '.mk3d', '.mlc', '.mmf', '.mod', '.mos', '.movie', '.mp2', '.mp2v', '.mp4v', '.mpa', '.mpe', '.mpv2', '.mrw', '.ms-windows-store-license', '.msepub', '.msm', '.msp', '.msrcincident', '.msstyles', '.msu', '.mts', '.mtx', '.mv', '.mydocs', '.natvis', '.ncb', '.netperf', '.nettrace', '.nfo', '.nls', '.nrw', '.nvr', '.nvram', '.oc_', '.odh', '.odl', '.oga', '.ogg', '.ogm', '.ogv', '.ogx', '.opus', '.orderedtest', '.ori', '.osdx', '.otf', '.ova', '.ovf', '.p10', '.p7m', '.p7r', '.p7s', '.pal', '.partial', '.pbk', '.pch', '.pcp', '.pds', '.pef', '.perfmoncfg', '.pfm', '.php3', '.pic', '.pkgdef', '.pkgundef', '.pko', '.pl', '.plg', '.pma', '.pmc', '.pml', '.pmr', '.pnf', '.pot', '.ppkg', '.ppt', '.prc', '.prf', '.printerexport', '.props', '.psh', '.pshader', '.ptx', '.publishproj', '.pubxml', '.pxn', '.pyo', '.pyw', '.pyz', '.pyzw', '.qds', '.raf', '.rat', '.razor', '.rc', '.rc2', '.rct', '.res', '.resmoncfg', '.resw', '.resx', '.rgs', '.rle', '.rll', '.rmi', '.rpc', '.rsp', '.rul', '.ruleset', '.rw2', '.rwl', '.s', '.sbr', '.sc2', '.scc', '.scd', '.scf', '.sch', '.scp', '.scss', '.sdl', '.search-ms', '.searchconnector-ms', '.sed', '.settingcontent-ms', '.sfcache', '.sh', '.shproj', '.shtm', '.shtml', '.sit', '.sitemap', '.skin', '.slnf', '.snd', '.snippet', '.snk', '.sol', '.sor', '.spc', '.sr2', '.srf', '.srw', '.sr_', '.sst', '.stvproj', '.suo', '.svc', '.svclog', '.sym', '.symlink', '.sys', '.sy_', '.tar', '.targets', '.tdl', '.testrunconfig', '.testsettings', '.text', '.tgz', '.theme', '.themepack', '.tiff', '.tlb', '.tlh', '.tli', '.tod', '.tpsr', '.trg', '.trx', '.ts', '.tsp', '.tsv', '.tsx', '.tt', '.ttc', '.ttf', '.tts', '.tvc', '.tvlink', '.tvs', '.txt', '.udf', '.udl', '.udt', '.uitest', '.user', '.usr', '.uvu', '.vb', '.vbhtml', '.vbox', '.vbox-extpack', '.vbproj', '.vbx', '.vcf', '.vcproj', '.vcxitems', '.vcxproj', '.vhd', '.vhdpmem', '.vhdx', '.viw', '.vmac', '.vmba', '.vmpl', '.vmsd', '.vmsn', '.vmss', '.vmt', '.vmtm', '.vmx', '.vmxf', '.vsct', '.vsglog', '.vsh', '.vshader', '.vsix', '.vsixlangpack', '.vsixmanifest', '.vsmdi', '.vsp', '.vsprops', '.vsps', '.vspscc', '.vsscc', '.vssettings', '.vssscc', '.vstemplate', '.vsz', '.vxd', '.wab', '.wax', '.wbcat', '.wcx', '.wdp', '.weba', '.webp', '.webpnp', '.website', '.wll', '.wlt', '.wm', '.wmd', '.wmdb', '.wmf', '.wmp', '.wms', '.wmx', '.wmz', '.wpa', '.wpapk', '.wpl', '.wri', '.wsdl', '.wsz', '.wtv', '.wtx', '.wvx', '.x', '.x3f', '.xaml', '.xbap', '.xdr', '.xht', '.xhtml', '.xix', '.xlb', '.xlc', '.xls', '.xproj', '.xrm-ms', '.xsc', '.xslt', '.xss', '.z', '.z96', '.zfsendtotarget', '.zoo', '._bsln140', '._bsln150', '._sln', '._sln100', '._sln110', '._sln120', '._sln140', '._sln150', '._sln160', '._sln170', '._sln60', '._sln70', '._sln71', '._sln80', '._sln90', '._vbxsln100', '._vbxsln110', '._vbxsln80', '._vbxsln90', '._vcppxsln100', '._vcppxsln110', '._vcppxsln80', '._vcppxsln90', '._vcsxsln100', '._vcsxsln110', '._vcsxsln80', '._vcsxsln90', '._vjsxsln80', '._vw8xsln110', '._vwdxsln100', '._vwdxsln110', '._vwdxsln120', '._vwdxsln140', '._vwdxsln150', '._vwdxsln80', '._vwdxsln90', '._vwinxsln120', '._vwinxsln140', '._vwinxsln150', '._wdxsln110', '._wdxsln120', '._wdxsln140', '._wdxsln150', '.all', '.amr', '.appinstaller', '.appx', '.appxbundle', '.c5e2524a-ea46-4f67-841f-6a9465d9d515', '.conf', '.daq', '.dpl', '.fbx', '.fd', '.fh', '.fud', '.glb', '.gltf', '.ids', '.iss', '.list', '.m3u8', '.m4r', '.md', '.mdc', '.mpg4', '.ms-lockscreencomponent-primary', '.msix', '.msixbundle', '.nupkg', '.one', '.oxps', '.ply', '.reputation', '.rwz', '.sample', '.sig', '.solitairetheme8', '.stl', '.thumb', '.winget', '.winmd', '.wsb', '.xvid', '.yaml', '.zpl', '.boe', '.cwp', '.jar', '.jnlp', '.jxl', '.lfm', '.lpi', '.lpk', '.lpr', '.oetpl', '.ovpn', '.pp', '.soe', '.tbz2', '.txz', '.tzst', '.wdq', '.zst', '.cnf', '.d', '.data', '.f4a', '.fluid', '.hdmp', '.kdmp', '.lastbuildstate', '.loop', '.mdmp', '.mxf', '.ndmp', '.note', '.opdownload', '.pyx', '.qt', '.recipe', '.rm', '.rmv', '.rmvb', '.run', '.tlog', '.whiteboard', '.yuv' ]

# Find and list new extensions for HKEY_LOCAL_MACHINE
for ext in hklm_file_types:
    if ext not in fileTypes:
        new_hklm_file_types.append(ext)

# Find and list new extensions for HKEY_CURRENT_USER, but only if they aren't in HKEY_LOCAL_MACHINE
for ext in hkcu_file_types:
    if ext not in fileTypes and ext not in hklm_file_types:
        new_hkcu_file_types.append(ext)

# Show results, prioritizing HKEY_LOCAL_MACHINE
print(f"New file extensions found under HKEY_LOCAL_MACHINE: {new_hklm_file_types}")
print(f"New file extensions found under HKEY_CURRENT_USER (not in HKEY_LOCAL_MACHINE): {new_hkcu_file_types}")
