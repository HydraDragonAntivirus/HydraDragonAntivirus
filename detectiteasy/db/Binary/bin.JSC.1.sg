// DIE's signature file
// Author: LinXP

init("format", "JavaScript Compiled/Bytenode (.JSC)");

var VersionHash = [
    ["11.8.172.17", "4aaade2a", "6e55fcb4"],
    ["11.3.244.8", "88b331c0", "bc2e4000"],
    ["10.8.168.25", "22162e5c", "866ceba8"],
    ["10.2.154.26", "353c3291", "82a06935"],
    ["9.6.180.15", "96a2e9d1", "77a0eea2"],
    ["9.6.180.14", "efecf234", "15e726e8"],
    ["9.5.172.25", "87f3c490", "7845cebc"],
    ["9.5.172.21", "22b0877a", "d54c6bc9"],
    ["9.4.146.26", "4f3466a4", "ee64ddac"],
    ["9.4.146.24", "34bdcb66", "251899cd"],
    ["9.4.146.19", "1c8f8b6a", "15375929"],
    ["8.6.395.17", "4e4909d8", "a8d671f0"],
    ["8.6.395.16", "2e933797", "42ff7bd2"],
    ["8.4.371.23", "422a9510", "305d5cb4"],
    ["8.4.371.19", "9ee57fe0", "8b279ced"],
    ["8.3.110.9", "98545131", "878c72a5"],
    ["8.1.307.31", "2cb9ba58", "8912ed09"],
    ["8.1.307.30", "22d2f67c", "f8e02587"],
    ["7.9.317.25", "e46e0ba2", "affe52ff"],
    ["7.9.317.23", "327e22f1", "a5ef90cb"],
    ["7.8.279.23", "f4ca7648", "2453843a"],
    ["7.8.279.17", "533dd511", "2e4f9afd"],
    ["7.7.299.13", "7ee98716", "8f1d647f"],
    ["7.7.299.11", "f4bd9236", "defcacc7"],
    ["7.6.303.29", "62a5311c", "905e664f"],
    ["7.4.288.27", "8d2f9651", "84fec91f"],
    ["7.5.288.22", "8176065f", "8b9ea960"],
    ["7.4.288.21", "4e79ebb1", "27f6dd21"],
    ["7.0.276.38", "5aa2a8c8", "261396d3"],
    ["7.0.276.32", "302bcaf2", "1c3c201f"],
    ["6.8.275.32", "4914c00b", "8af4d4f4"],
    ["6.8.275.30", "34fd59c5", "91d1cc59"],
    ["6.8.275.24", "70ff0c52", "74a2eeac"],
    ["6.7.288.49", "f5e4a619", "aa47d109"],
    ["6.7.288.46", "555f09bb", "6070752b"],
    ["6.7.288.45", "3f06ef23", "ca0b678f"],
    ["6.7.288.43", "bc67142f", "884dad18"],
    ["6.6.346.32", "9ac1441d", "600024b1"],
    ["6.6.346.27", "741c5f3b", "91b8852b"],
    ["6.6.346.24", "cbb74c67", "3e6b9b38"],
    ["6.2.414.78", "4d9d4c8d", "c2f91993"],
    ["6.2.414.77", "2e12ba35", "818125c8"],
    ["6.2.414.72", "90a269a0", "96890b15"],
    ["6.2.414.66", "a8f60b85", "36eba645"],
    ["6.2.414.54", "6ed53280", "82f11b7d"],
    ["6.2.414.50", "ae6544a8", "bd692ce0"],
    ["6.2.414.46", "4e617339", "81adf054"],
    ["6.2.414.44", "c60a7c87", "7e207921"],
    ["6.2.414.32", "42110b24", "84d039aa"],
    ["6.1.534.50", "a0f6f0f4", "9e10b69f"],
    ["6.1.534.48", "f14f22a0", "82467775"],
    ["6.1.534.47", "79276eb0", "221a8fc5"],
    ["6.1.534.46", "babe69a4", "64318412"],
    ["6.1.534.42", "166f25d9", "9892d1c2"],
    ["6.0.287.53", "a1bc32d4", "6fcdcd18"],
    ["6.0.286.52", "2cf4293d", "a030b731"],
    ["5.5.372.43", "b96063d0", "c10a0c40"],
    ["5.1.281.111", "bb23baab", "78f44bee"],
    ["4.6.85.32", "35a37732", "ca4b83fd"],
    ["4.5.103.53", "15953e0e", "b217e70b"],
    ["3.28.71.20", "26145e77", "fec9a40d"],
];

function detect(bShowType, bShowVersion, bShowOptions) {
    if (Binary.getSize() >= 0x20) {
        if (Binary.compare("DEC0", 0x02)) {
            bDetected = true;
            for (i = 0; i < VersionHash.length; i++) {
                if (Binary.compare(VersionHash[i][1], 0x04)) {
                    sVersion = "v" + VersionHash[i][0] + " x86"
                } else if (Binary.compare(VersionHash[i][2], 0x04)) {
                    sVersion = "v" + VersionHash[i][0] + " x64"
                };
            }
        }
    }


    _setLang("JavaScript", bDetected);
    return result(bShowType, bShowVersion, bShowOptions);
}